# π— CAN κΈ°λ° λ¶„μ‚° ECU λ¬΄μΈ λ°°λ‹¬ μ°¨λ‰ μ‹μ¤ν…

> **Intel AI SW Academy 9κΈ° 1μ°¨ ν”„λ΅μ νΈ**
> STM32 + Raspberry Pi κΈ°λ° CAN ν†µμ‹  λ¶„μ‚° ECU μ•„ν‚¤ν…μ²λ΅ κµ¬ν„ν• λ¬΄μΈ λ°°λ‹¬ μ°¨λ‰ μ‹μ¤ν…

---

## π“ ν”„λ΅μ νΈ κ°μ”

μ‹¤μ  μ°¨λ‰μ ECU λ¶„μ‚° κµ¬μ΅°(μ£Όν–‰/λ―Έμ…/ν™”λ¬Όν•¨)λ¥Ό RCμΉ΄λ΅ μ¬ν„ν•μ—¬ CAN ν†µμ‹  κΈ°λ° μ„λ² λ””λ“ μ‹μ¤ν… μ„¤κ³„ μ—­λ‰μ„ κ²€μ¦ν•λ” ν”„λ΅μ νΈμ…λ‹λ‹¤.

λΌμΈνΈλ μ΄μ„ κΈ°λ° μμ¨ μ£Όν–‰, λΉ„λ°€λ²νΈ μΈμ¦ ν™”λ¬Όν•¨ μ μ–΄, Qt κΈ°λ° μ£Όλ¬Έ ν΄λΌμ΄μ–ΈνΈ, MQTT μ‹¤μ‹κ°„ κ΄€μ λ¥Ό ν•λ‚μ μ‹μ¤ν…μΌλ΅ ν†µν•©ν•©λ‹λ‹¤.

---

## π—οΈ μ‹μ¤ν… μ•„ν‚¤ν…μ²

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚           RCμΉ΄ (μ¨λ³΄λ“)           β”‚
β”‚                                  β”‚
β”‚  STM32 β”€β”€β”€β”€β”€β”€β”                    β”‚
β”‚  (μ£Όν–‰ ECU)   β”‚                   β”‚
β”‚              CAN λ²„μ¤ (250kbps)   β”‚
β”‚  RPi1 β”€β”€β”€β”€β”€β”€β”€β”¤                    β”‚
β”‚  (λ―Έμ… ECU)   β”‚                   β”‚
β”‚              β”‚                   β”‚
β”‚  RPi2 β”€β”€β”€β”€β”€β”€β”€β”                    β”‚
β”‚  (ν™”λ¬Όν•¨ ECU) β”‚                   β”‚
β”‚              β”‚ MQTT (λ¬΄μ„ )        β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
               β”‚
          β”β”€β”€β”€β”€β–Όβ”€β”€β”€β”€β”
          β”‚  RPi3  β”‚  β† μ„λ²„ (μ¤ν”„λ³΄λ“)
          β””β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”
               β”‚ MQTT (λ¬΄μ„ )
          β”β”€β”€β”€β”€β–Όβ”€β”€β”€β”€β”
          β”‚  RPi4  β”‚  β† ν΄λΌμ΄μ–ΈνΈ (μ¤ν”„λ³΄λ“)
          β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## π–¥οΈ λ…Έλ“λ³„ μ—­ν• 

| λ…Έλ“ | λ³΄λ“ | μ—­ν•  |
|---|---|---|
| STM32 | B-L475E-IOT01A | μ£Όν–‰ ECU β€” λ¨ν„° PWM, μ—”μ½”λ”, μ†λ„ PID, CAN |
| RPi1 | Raspberry Pi 5 | λ―Έμ… ECU β€” λΌμΈνΈλ μ΄μ‹±, μ΄μν, λ¨λ“ νλ‹¨ |
| RPi2 | Raspberry Pi 5 | ν™”λ¬Όν•¨ ECU β€” λΉ„λ°€λ²νΈ μΈμ¦, μ„λ³΄, LCD |
| RPi3 | Raspberry Pi 5 | μ„λ²„ β€” MQTT λΈλ΅μ»¤, λ΅κ·Έ, κ΄€μ  UI |
| RPi4 | Raspberry Pi 5 | ν΄λΌμ΄μ–ΈνΈ β€” Qt μ£Όλ¬Έ UI, ν„°μΉ λ””μ¤ν”λ μ΄ |

---

## β™οΈ κΈ°μ  μ¤νƒ

| μμ—­ | κΈ°μ  |
|---|---|
| STM32 νμ›¨μ–΄ | C + STM32 HAL (CubeMX) |
| λ―Έμ… λ΅μ§ / λΌμΈνΈλ μ΄μ‹± | C++ + OpenCV + SocketCAN |
| ν™”λ¬Όν•¨ μ μ–΄ | C++ + SocketCAN + wiringPi |
| μ„λ²„ / λΈλ΅μ»¤ | C++ + Mosquitto + SQLite |
| μ£Όλ¬Έ ν΄λΌμ΄μ–ΈνΈ UI | C++ + Qt Widgets |
| ν†µμ‹  (μ¨λ³΄λ“) | CAN Bus 250kbps (bxCAN / MCP2515) |
| ν†µμ‹  (μ¤ν”„λ³΄λ“) | MQTT (Mosquitto) |
| λΉλ“ λ„κµ¬ | STM32CubeIDE / CMake |

---

## π“‚ λΈλμΉ κµ¬μ΅°

```
main                  β† μµμΆ… ν†µν•© (μ§μ ‘ push κΈμ§€)
dev                   β† ν†µν•© ν…μ¤νΈ
feature/stm32         β† STM32 νμ›¨μ–΄
feature/rpi1          β† RPi1 λ―Έμ… ECU
feature/rpi2          β† RPi2 ν™”λ¬Όν•¨ ECU
feature/rpi3          β† RPi3 μ„λ²„
feature/rpi4          β† RPi4 ν΄λΌμ΄μ–ΈνΈ

# stm32λ¥Ό λ‘ λ…μ—μ„ λ§΅λ” κ²½μ° feature/stm32_name ν•μ‹μΌλ΅ λΈλμΉ λ‚λ”
```

---

## π“ λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```
can-based-autonomous-delivery-car/
β”β”€β”€ stm32/              # STM32 CubeIDE ν”„λ΅μ νΈ
β”‚    β”β”€β”€ Core/
β”‚    β””β”€β”€ Drivers/
β”β”€β”€ rpi1/               # RPi1 λ―Έμ… ECU (C/C++)
β”‚    β”β”€β”€ src/
β”‚    β””β”€β”€ CMakeLists.txt
β”β”€β”€ rpi2/               # RPi2 ν™”λ¬Όν•¨ ECU (C/C++)
β”‚    β”β”€β”€ src/
β”‚    β””β”€β”€ CMakeLists.txt
β”β”€β”€ rpi3/               # RPi3 μ„λ²„ (C/C++)
β”‚    β”β”€β”€ src/
β”‚    β””β”€β”€ CMakeLists.txt
β”β”€β”€ rpi4/               # RPi4 ν΄λΌμ΄μ–ΈνΈ (C/C++)
β”‚    β”β”€β”€ src/
β”‚    β””β”€β”€ CMakeLists.txt
β””β”€β”€ docs/               # μ„¤κ³„ λ¬Έμ„
     β”β”€β”€ architecture.md
     β””β”€β”€ can_id_design.md
```

---

## π” μ£Όμ” ν•λ“μ›¨μ–΄

| λ¶€ν’ | μ©λ„ |
|---|---|
| STM32 B-L475E-IOT01A | μ£Όν–‰ ECU |
| Raspberry Pi Γ— 4 | λ―Έμ…/ν™”λ¬Όν•¨/μ„λ²„/ν΄λΌμ΄μ–ΈνΈ ECU |
| JGB37-520 μ—”μ½”λ” λ¨ν„° Γ— 4 | μ¤ν‚¤λ“ μ¤ν‹°μ–΄λ§ κµ¬λ™ |
| L298N λ¨ν„° λ“λΌμ΄λ²„ | μΆμ° λ°”ν€΄ PWM μ μ–΄ |
| MCP2515 CAN λ¨λ“ Γ— 2 | RPi CAN ν†µμ‹  |
| SN65HVD230 CAN νΈλμ‹λ²„ | STM32 CAN λ¬Όλ¦¬ κ³„μΈµ |
| HC-SR04 μ΄μν μ„Όμ„ Γ— 3 | μ¥μ• λ¬Ό κ°μ§€ |
| VL53L0X | μ „λ°© μ •λ°€ κ±°λ¦¬ (μ¨λ³΄λ“ λ‚΄μ¥) |
| LCD 1602 (I2C) | ν™”λ¬Όν•¨ ν„μ¥ μ•λ‚΄ ν‘μ‹ |
| 5μΈμΉ ν„°μΉ λ””μ¤ν”λ μ΄ (XPT2046) | μ£Όλ¬Έ UI |
| 4Γ—4 ν‚¤ν¨λ“ | λΉ„λ°€λ²νΈ μ…λ ¥ |
| μ†ν• μ„λ³΄ λ¨ν„° | ν™”λ¬Όν•¨ λ„μ–΄ μ μ–΄ |

---

## π€ μ „μ²΄ λ°°λ‹¬ μ‹λ‚λ¦¬μ¤

```
β‘  κ³ κ° μ£Όλ¬Έ    RPi4 Qt UI β†’ λ©”λ‰΄/λ©μ μ§€/λΉ„λ°€λ²νΈ μ…λ ¥ β†’ RPi3 μ „μ†΅
β‘΅ μμ¨ μ£Όν–‰   RPi1 λΌμΈνΈλ μ΄μ‹± β†’ CAN β†’ STM32 λ¨ν„° μ μ–΄
β‘Ά λ©μ μ§€ λ„μ°©  λ„μ°© μ‹ νΈ β†’ RPi3 β†’ RPi2 μ κΈ ν•΄μ  ν—μ©
β‘£ ν™”λ¬Όν•¨ μΈμ¦  ν‚¤ν¨λ“ λΉ„λ°€λ²νΈ μ…λ ¥ β†’ μΌμΉ μ‹ μ„λ³΄ μ¤ν”
β‘¤ κ·€ν™        180λ„ νμ „ β†’ λΌμΈ μ—­μ¶”μ  β†’ μ¶λ°μ§€ λ³µκ·€
```

---

## π‘¥ ν€ κµ¬μ„±

| μ΄λ¦„ | λ‹΄λ‹Ή |
|---|---|
| κµ¬μλ¨ | PM / HW / STM32_FW  |
| μΈμλ―Ό | HW / STM32_FW |
| κΉ€λ―Όμ° | PL / RPi1 λ―Έμ… ECU / HW /  RPi2 ν™”λ¬Όν•¨ ECU |
| μ¤μ„±μ§„ | RPi1 Vision / RPi4 ν΄λΌμ΄μ–ΈνΈ |
| μµμ§€νΈ | RPi3 μ„λ²„ / RPi4 ν΄λΌμ΄μ–ΈνΈ |

---

## π“‹ μ»¤λ°‹ μ»¨λ²¤μ…

```
[λ¨λ“] μ‘μ—… λ‚΄μ©

μμ‹:
[STM32] CAN TX κΈ°λ³Έ μ†΅μ‹  κµ¬ν„
[RPi1]  OpenCV λΌμΈ κ°μ§€ κµ¬ν„
[RPi2]  λΉ„λ°€λ²νΈ κ²€μ¦ λ΅μ§ κµ¬ν„
[RPi3]  Mosquitto MQTT λΈλ΅μ»¤ μ„¤μ •
[RPi4]  Qt μ£Όλ¬Έ UI λ μ΄μ•„μ›ƒ κµ¬μ„±
[docs]  CAN ID μ„¤κ³„ λ¬Έμ„ μ—…λ°μ΄νΈ
```

---

## β οΈ μ£Όμμ‚¬ν•­

- `main` λΈλμΉ μ§μ ‘ push κΈμ§€
- `dev` λΈλμΉ λ¨Έμ§€ μ „ ν€μ› 1λ… μ΄μƒ μ½”λ“ λ¦¬λ·° ν•„μ
- MCP2515λ” **3.3V λ²„μ „** κµ¬λ§¤ ν•„μ (5V λ²„μ „ μ‹ RPi GPIO μ†μƒ)
- JGB37-520 μ—”μ½”λ” μ‹ νΈ 5V β†’ STM32 3.3V **λ λ²¨μ‹ν”„ν„° ν•„μ**
- CAN λ²„μ¤ μ–‘ λ **120Ξ© μΆ…λ‹¨ μ €ν•­** ν•„μ
